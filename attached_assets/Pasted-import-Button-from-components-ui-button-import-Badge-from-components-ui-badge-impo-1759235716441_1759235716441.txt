import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { ArrowLeft, Save, Loader2, ChevronRight } from 'lucide-react';
import { formatDistanceToNow } from 'date-fns';

interface ProjectHeaderProps {
  project: any;
  breadcrumb?: string[];
  wordCount: number;
  saveStatus: 'saved' | 'saving' | 'unsaved';
  lastSaveTime: Date | null;
  onBack: () => void;
  onManualSave: () => void;
  isSaving: boolean;
}

export function ProjectHeader({
  project,
  breadcrumb = [],
  wordCount,
  saveStatus,
  lastSaveTime,
  onBack,
  onManualSave,
  isSaving,
}: ProjectHeaderProps) {
  return (
    <div className="border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60">
      <div className="flex items-center justify-between px-4 py-3">
        {/* Left: Back button and breadcrumb */}
        <div className="flex items-center gap-3 flex-1 min-w-0">
          <Button
            variant="ghost"
            size="sm"
            onClick={onBack}
            className="flex-shrink-0"
          >
            <ArrowLeft className="h-4 w-4 mr-2" />
            Back
          </Button>

          <div className="flex items-center gap-2 min-w-0 text-sm">
            {/* Project title */}
            <span className="font-semibold truncate">
              {project?.title || 'Untitled Project'}
            </span>

            {/* Breadcrumb trail */}
            {breadcrumb.length > 0 && (
              <>
                <ChevronRight className="h-4 w-4 text-muted-foreground flex-shrink-0" />
                {breadcrumb.map((crumb, index) => (
                  <div key={index} className="flex items-center gap-2">
                    <span className={index === breadcrumb.length - 1 ? 'font-medium' : 'text-muted-foreground'}>
                      {crumb}
                    </span>
                    {index < breadcrumb.length - 1 && (
                      <ChevronRight className="h-4 w-4 text-muted-foreground flex-shrink-0" />
                    )}
                  </div>
                ))}
              </>
            )}
          </div>
        </div>

        {/* Right: Stats and save button */}
        <div className="flex items-center gap-4 flex-shrink-0">
          {/* Word count */}
          <div className="text-sm text-muted-foreground">
            {wordCount.toLocaleString()} words
          </div>

          {/* Save status */}
          <div className="flex items-center gap-2">
            {saveStatus === 'saving' && (
              <Badge variant="secondary" className="gap-1">
                <Loader2 className="h-3 w-3 animate-spin" />
                Saving...
              </Badge>
            )}
            {saveStatus === 'saved' && lastSaveTime && (
              <Badge variant="secondary" className="gap-1">
                Saved {formatDistanceToNow(lastSaveTime, { addSuffix: true })}
              </Badge>
            )}
            {saveStatus === 'unsaved' && (
              <Badge variant="destructive">
                Unsaved changes
              </Badge>
            )}
          </div>

          {/* Manual save button */}
          <Button
            size="sm"
            onClick={onManualSave}
            disabled={isSaving || saveStatus === 'saved'}
          >
            {isSaving ? (
              <Loader2 className="h-4 w-4 mr-2 animate-spin" />
            ) : (
              <Save className="h-4 w-4 mr-2" />
            )}
            Save
          </Button>
        </div>
      </div>
    </div>
  );
}